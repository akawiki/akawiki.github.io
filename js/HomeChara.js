function SortChara(){for(var n=0;n<g_curch.length;++n)g_curch[n].sc=n;0==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.ch.namej<t.ch.namej?-1:n.ch.namej>t.ch.namej?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.ch.namej>t.ch.namej?-1:n.ch.namej<t.ch.namej?1:n.sc<t.sc?-1:1}):1==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.ch.type<t.ch.type?-1:n.ch.type>t.ch.type?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.ch.type>t.ch.type?-1:n.ch.type<t.ch.type?1:n.sc<t.sc?-1:1}):2==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.ch.genr<t.ch.genr?-1:n.ch.genr>t.ch.genr?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.ch.genr>t.ch.genr?-1:n.ch.genr<t.ch.genr?1:n.sc<t.sc?-1:1}):3==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.pow<t.chf.pow?-1:n.chf.pow>t.chf.pow?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.pow>t.chf.pow?-1:n.chf.pow<t.chf.pow?1:n.sc<t.sc?-1:1}):4==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.hp<t.chf.hp?-1:n.chf.hp>t.chf.hp?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.hp>t.chf.hp?-1:n.chf.hp<t.chf.hp?1:n.sc<t.sc?-1:1}):5==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.str<t.chf.str?-1:n.chf.str>t.chf.str?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.str>t.chf.str?-1:n.chf.str<t.chf.str?1:n.sc<t.sc?-1:1}):6==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.def<t.chf.def?-1:n.chf.def>t.chf.def?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.def>t.chf.def?-1:n.chf.def<t.chf.def?1:n.sc<t.sc?-1:1}):7==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.ats<t.chf.ats?-1:n.chf.ats>t.chf.ats?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.ats>t.chf.ats?-1:n.chf.ats<t.chf.ats?1:n.sc<t.sc?-1:1}):8==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.adf<t.chf.adf?-1:n.chf.adf>t.chf.adf?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.adf>t.chf.adf?-1:n.chf.adf<t.chf.adf?1:n.sc<t.sc?-1:1}):9==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.spd<t.chf.spd?-1:n.chf.spd>t.chf.spd?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.spd>t.chf.spd?-1:n.chf.spd<t.chf.spd?1:n.sc<t.sc?-1:1}):10==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.mlv.dex<t.mlv.dex?-1:n.mlv.dex>t.mlv.dex?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.mlv.dex>t.mlv.dex?-1:n.mlv.dex<t.mlv.dex?1:n.sc<t.sc?-1:1}):11==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.mlv.agl<t.mlv.agl?-1:n.mlv.agl>t.mlv.agl?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.mlv.agl>t.mlv.agl?-1:n.mlv.agl<t.mlv.agl?1:n.sc<t.sc?-1:1}):12==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.ch.mov<t.ch.mov?-1:n.ch.mov>t.ch.mov?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.ch.mov>t.ch.mov?-1:n.ch.mov<t.ch.mov?1:n.sc<t.sc?-1:1}):13==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.ch.rng<t.ch.rng?-1:n.ch.rng>t.ch.rng?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.ch.rng>t.ch.rng?-1:n.ch.rng<t.ch.rng?1:n.sc<t.sc?-1:1}):14==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.cri<t.chf.cri?-1:n.chf.cri>t.chf.cri?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.cri>t.chf.cri?-1:n.chf.cri<t.chf.cri?1:n.sc<t.sc?-1:1}):15==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.dex<t.chf.dex?-1:n.chf.dex>t.chf.dex?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.dex>t.chf.dex?-1:n.chf.dex<t.chf.dex?1:n.sc<t.sc?-1:1}):16==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.chf.agl<t.chf.agl?-1:n.chf.agl>t.chf.agl?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.chf.agl>t.chf.agl?-1:n.chf.agl<t.chf.agl?1:n.sc<t.sc?-1:1}):17==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){for(var i=5;i>=0;--i){if(n.ch.slot[i]>t.ch.slot[i])return-1;if(n.ch.slot[i]<t.ch.slot[i])return 1}return n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){for(var i=5;i>=0;--i){if(n.ch.slot[i]<t.ch.slot[i])return-1;if(n.ch.slot[i]>t.ch.slot[i])return 1}return n.sc<t.sc?-1:1}):18==g_sortitem?0==g_sortorder?g_curch.sort(function(n,t){return n.ch.tw<t.ch.tw?-1:n.ch.tw>t.ch.tw?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.ch.tw>t.ch.tw?-1:n.ch.tw<t.ch.tw?1:n.sc<t.sc?-1:1}):19==g_sortitem&&(0==g_sortorder?g_curch.sort(function(n,t){return n.ch.ta<t.ch.ta?-1:n.ch.ta>t.ch.ta?1:n.sc<t.sc?-1:1}):g_curch.sort(function(n,t){return n.ch.ta>t.ch.ta?-1:n.ch.ta<t.ch.ta?1:n.sc<t.sc?-1:1}))}function UpdateEquipment(){for(var n,i,r,u,t,f=0;f<g_curch.length;++f){if(n=g_curch[f],i=g_chad[n.oi],n.chf.hp=n.mlv.hp,n.chf.str=n.mlv.str,n.chf.def=n.mlv.def,n.chf.ats=n.mlv.ats,n.chf.adf=n.mlv.adf,n.chf.spd=n.mlv.spd,n.chf.cri=0,n.chf.dex=0,n.chf.agl=0,n.chf.hpd=0,n.chf.strd=0,n.chf.defd=0,n.chf.atsd=0,n.chf.adfd=0,n.chf.spdd=0,1==n.ch.clo&&g_cloth>0&&(n.chf.hp+=Math.ceil(n.chf.hp*.02*g_cloth),n.chf.str+=Math.ceil(n.chf.str*.02*g_cloth),n.chf.def+=Math.ceil(n.chf.def*.02*g_cloth),n.chf.ats+=Math.ceil(n.chf.ats*.02*g_cloth),n.chf.adf+=Math.ceil(n.chf.adf*.02*g_cloth)),-1!=g_weapon){for(r=0,u=0,g_weapon<20?(r=g_weapon>>1,u=(1&g_weapon)*9):(r=Math.floor(g_weaponc/10),u=g_weaponc%10),t=0;t<i.stre.length;++t)n.chf.strd+=Math.floor(i.stre[t].i[r]+u*i.stre[t].g[r]);for(t=0;t<i.atse.length;++t)n.chf.atsd+=Math.floor(i.atse[t].i[r]+u*i.atse[t].g[r]);for(t=0;t<i.spde.length;++t)n.chf.spdd+=Math.floor(i.spde[t].i[r]+u*i.spde[t].g[r]);for(t=0;t<i.defw.length;++t)n.chf.defd+=Math.floor(i.defw[t].i[r]+u*i.defw[t].g[r]);for(t=0;t<i.crw.length;++t)n.chf.cri+=i.crw[t].i[r];for(t=0;t<i.dew.length;++t)n.chf.dex+=i.dew[t].i[r];for(t=0;t<i.agw.length;++t)n.chf.agl+=i.agw[t].i[r]}if(-1!=g_armor){for(r=0,u=0,g_armor<20?(r=g_armor>>1,u=(1&g_armor)*9):(r=Math.floor(g_armorc/10),u=g_armorc%10),t=0;t<i.hpe.length;++t)n.chf.hpd+=Math.floor(i.hpe[t].i[r]+u*i.hpe[t].g[r]);for(t=0;t<i.defe.length;++t)n.chf.defd+=Math.floor(i.defe[t].i[r]+u*i.defe[t].g[r]);for(t=0;t<i.adfe.length;++t)n.chf.adfd+=Math.floor(i.adfe[t].i[r]+u*i.adfe[t].g[r]);for(t=0;t<i.cra.length;++t)n.chf.cri+=i.cra[t].i[r];for(t=0;t<i.dea.length;++t)n.chf.dex+=i.dea[t].i[r];for(t=0;t<i.aga.length;++t)n.chf.agl+=i.aga[t].i[r]}n.chf.hp+=n.chf.hpd;n.chf.str+=n.chf.strd;n.chf.ats+=n.chf.atsd;n.chf.spd+=n.chf.spdd;n.chf.def+=n.chf.defd;n.chf.adf+=n.chf.adfd;n.chf.pow=Math.floor((n.chf.hp*4+n.chf.str*10+n.chf.ats*10+n.chf.def*5+n.chf.adf*5)*n.chf.spd/200)}}function GenCol(n,t,i,r,u){var f='<td class="text-right';return n&&(f+=" td-sn-l"),t==g_sortitem&&(f+=" col-sort"),g_cloth>0&&1==i&&(f+=" text-cloth"),f+='">'+r+"<\/td>",-1!=n?(f+='<td class="td-sn-r xs',t==g_sortitem&&(f+=" col-sort"),f+=u>0?' text-green">(+'+u+")":u<0?' text-red">(-'+-u+")":'">',f+="<\/td>"):f+='<td style="td-sn-r0"><\/td>',f}function UpdateDisplay(){var s=$("#divType").find("div"),h=$("#divGenre").find("div"),c=$("#divAT").find("div"),l=$("#divGender").find("div"),a=$("#divWeapon").find("div"),v=$("#divArmor").find("div"),y=$("#divCloth").find("div"),o,r,w,b,i,t,n,f;for(s.removeClass("btn-primary"),h.removeClass("btn-primary"),c.removeClass("btn-primary"),l.removeClass("btn-primary"),a.removeClass("active"),v.removeClass("active"),y.removeClass("btn-primary"),$(s[g_type+1]).addClass("btn-primary"),$(h[g_genre+1]).addClass("btn-primary"),$(c[g_at+1]).addClass("btn-primary"),$(l[g_gender+1]).addClass("btn-primary"),$(a[g_weapon+1]).addClass("active"),$(v[g_armor+1]).addClass("active"),$(y[g_cloth]).addClass("btn-primary"),o=$("#tbl"),r="",r+='<thead><tr class="table-tr-link">',i=0;i<g_col.length;++i)n='<td data-sort="'+i+'" class="chara-sort',1==g_col[i].rc?n+=" text-center":2==g_col[i].rc&&(n+=" text-right"),i==g_sortitem&&(n+=" col-sort"),n+=g_col[i].dv?'" colspan="2">':'">',i==g_sortitem&&(n+=0==g_sortorder?'<span class="glyphicon glyphicon-triangle-top"><\/span>':'<span class="glyphicon glyphicon-triangle-bottom"><\/span>'),n+=g_col[i].name,n+="<\/td>",r+=n;for(r+="<\/tr><\/thead>",r+="<tbody>",w="",b=-1,i=0;i<g_curch.length;++i)if((t=g_curch[i],-1==g_type||g_type==t.ch.type)&&(-1==g_genre||g_genre==t.ch.genr)&&(-1==g_at||g_at==(g_chad[t.oi].stre.length>0?0:1))&&(-1==g_gender||g_gender==t.ch.gend)){n='<tr class="table-tr-wlink" data-id="'+t.ch.id+'"><td class="';0==g_sortitem&&(n+="col-sort");n+='">';n+=g_bigimg?'<img class="img-rounded" src="/images/ch/'+t.ch.id+'.jpg" />':'<div class="chara-head-container-xs"><div class="img-rounded"><img src="/images/ch/'+t.ch.id+'.jpg" /><\/div><\/div>';n+=t.ch.namej;t.chn.namen.length>0&&(n+='<span class="text-green">('+t.chn.namen+")<\/span>");n+="<\/td>";n+='<td class="';1==g_sortitem&&(n+="col-sort");n+='"><span class="img-circle etype'+t.ch.type+'"><\/span><\/td>';n+='<td class="';2==g_sortitem&&(n+="col-sort");n+='">'+g_gentype[t.ch.genr]+"<\/td>";n+='<td class="text-right';3==g_sortitem&&(n+=" col-sort");n+='">'+t.chf.pow+"<\/td>";n+=GenCol(-1!=g_armor,4,t.ch.clo,t.chf.hp,t.chf.hpd);n+=GenCol(-1!=g_weapon,5,t.ch.clo,t.chf.str,t.chf.strd);n+=GenCol(-1!=g_armor,6,t.ch.clo,t.chf.def,t.chf.defd);n+=GenCol(-1!=g_weapon,7,t.ch.clo,t.chf.ats,t.chf.atsd);n+=GenCol(-1!=g_armor,8,t.ch.clo,t.chf.adf,t.chf.adfd);n+=GenCol(-1!=g_weapon,9,t.ch.clo,t.chf.spd,t.chf.spdd);n+='<td class="text-center';10==g_sortitem&&(n+=" col-sort");n+='">'+t.mlv.dex+"<\/td>";n+='<td class="text-center';11==g_sortitem&&(n+=" col-sort");n+='">'+t.mlv.agl+"<\/td>";n+='<td class="text-center';12==g_sortitem&&(n+=" col-sort");n+='">'+t.ch.mov+"<\/td>";n+='<td class="text-center';13==g_sortitem&&(n+=" col-sort");n+='">'+t.ch.rng+"<\/td>";n+='<td class="text-right';14==g_sortitem&&(n+=" col-sort");n+=t.chf.cri>0?' text-green">+'+t.chf.cri+"%":'">';n+="<\/td>";n+='<td class="text-right';15==g_sortitem&&(n+=" col-sort");n+=t.chf.dex>0?' text-green">+'+t.chf.dex+"%":t.chf.dex<0?' text-red">-'+-t.chf.dex+"%":'">';n+="<\/td>";n+='<td class="text-right';16==g_sortitem&&(n+=" col-sort");n+=t.chf.agl>0?' text-green">+'+t.chf.agl+"%":t.chf.agl<0?' text-red">-'+-t.chf.agl+"%":'">';n+="<\/td>";n+='<td class="';17==g_sortitem&&(n+=" col-sort");n+='">';var u=0,p=-1,e=1;for(f=0;f<t.ch.slot.length;++f)p!=t.ch.slot[f]?(u>0&&(e?e=0:n+="-",n+=u),p=t.ch.slot[f],u=1):++u;u>0&&(e?e=0:n+="-",n+=u);n+="<\/td>";n+='<td class="';18==g_sortitem&&(n+="col-sort");n+=t.ch.tw>0?'"><span class="weapon-icon-'+t.ch.tw+'"><\/span><\/td>':'"><span class="glyphicon glyphicon-asterisk"><\/span><\/td>';n+='<td class="';19==g_sortitem&&(n+="col-sort");n+=t.ch.ta>0?'">'+g_str_at[t.ch.ta]+"<\/td>":'"><span class="glyphicon glyphicon-asterisk"><\/span><\/td>';n+="<\/tr>";r+=n}r+="<\/tbody>";o.html(r);o.AffixThead(g_AffixThead)}var g_col=[{dv:0,rc:0,name:g_colname},{dv:0,rc:0,name:g_coltype},{dv:0,rc:0,name:g_colgenre},{dv:0,rc:1,name:g_colpow},{dv:1,rc:1,name:"HP"},{dv:1,rc:1,name:"STR"},{dv:1,rc:1,name:"DEF"},{dv:1,rc:1,name:"ATS"},{dv:1,rc:1,name:"ADF"},{dv:1,rc:1,name:"SPD"},{dv:0,rc:1,name:"DEX"},{dv:0,rc:1,name:"AGL"},{dv:0,rc:1,name:"MOV"},{dv:0,rc:1,name:"RNG"},{dv:0,rc:2,name:"CRI"},{dv:0,rc:2,name:g_coldex},{dv:0,rc:2,name:g_colagl},{dv:0,rc:0,name:g_colslot},{dv:0,rc:0,name:g_str_weapon},{dv:0,rc:0,name:g_str_armor},],g_sortitem=0,g_sortorder=0,g_type=-1,g_genre=-1,g_at=-1,g_gender=-1,g_weapon=0,g_weaponc=0,g_armor=0,g_armorc=0,g_trcpick=0,g_cloth=0,g_bigimg=0,g_curch=[];$("body").on("click",".chara-sort",function(){var n=$(this).attr("data-sort");!n||n<0||n>=g_col.length||(n==g_sortitem?g_sortorder^=1:(g_sortitem=n,g_sortorder=n>=3&&n<=17?1:0),SortChara(),UpdateDisplay())});$("body").on("click",".table-tr-wlink",function(){for(var e,t,h,ot,st,ht,u,ct,o,lt,at,b,w,s,k,tt=parseInt($(this).attr("data-id")),i=-1,c=-1,f=0;-1==i&&f<g_chad.length;++f)tt==g_chad[f].id&&(i=f);if(c=ch_id2index(tt),-1!=i&&-1!=c){var vt=$("#divWeapon").find("div"),yt=$("#divArmor").find("div"),pt=$("#divCloth").find("div"),d=g_ch[c],r=g_chad[i],n=d.namej;g_chn[c].namen.length>0&&(n+='<span class="text-green">('+g_chn[c].namen+")<\/span>");n+=' <span class="label label-primary">'+g_str_weapon;n+=-1==g_weapon?' <span class="glyphicon glyphicon-ban-circle"><\/span>':" "+$(vt[g_weapon+1]).text();n+="<\/span>";n+=' <span class="label label-primary">'+g_str_armor;n+=-1==g_armor?' <span class="glyphicon glyphicon-ban-circle"><\/span>':" "+$(yt[g_armor+1]).text();n+="<\/span>";1==d.clo&&(n+=' <span class="label label-primary">'+g_str_cloth,n+=g_cloth>0?" "+$(pt[g_cloth]).text():' <span class="glyphicon glyphicon-ban-circle"><\/span>',n+="<\/span>");$("#chname").html(n);var it=0,rt=0,g=0,ut=0,ft=0,et=0;if(-1!=g_weapon){for(i=0,e=0,g_weapon<20?(i=g_weapon>>1,e=(1&g_weapon)*9):(i=Math.floor(g_weaponc/10),e=g_weaponc%10),t=0;t<r.stre.length;++t)rt+=Math.floor(r.stre[t].i[i]+e*r.stre[t].g[i]);for(t=0;t<r.atse.length;++t)ut+=Math.floor(r.atse[t].i[i]+e*r.atse[t].g[i]);for(t=0;t<r.spde.length;++t)et+=Math.floor(r.spde[t].i[i]+e*r.spde[t].g[i]);for(t=0;t<r.defw.length;++t)g+=Math.floor(r.defw[t].i[i]+e*r.defw[t].g[i])}if(-1!=g_armor){for(i=0,e=0,g_armor<20?(i=g_armor>>1,e=(1&g_armor)*9):(i=Math.floor(g_armorc/10),e=g_armorc%10),t=0;t<r.hpe.length;++t)it+=Math.floor(r.hpe[t].i[i]+e*r.hpe[t].g[i]);for(t=0;t<r.defe.length;++t)g+=Math.floor(r.defe[t].i[i]+e*r.defe[t].g[i]);for(t=0;t<r.adfe.length;++t)ft+=Math.floor(r.adfe[t].i[i]+e*r.adfe[t].g[i])}for(h=0;h<6;++h){for(ot=$("#chr"+(h+1)).find("tbody"),n="",st=5==h?6:1,ht=0,f=0;f<st;++f)for(u=r.lv[h+f],ct=0==f?30:3,o=0==f?0:1;o<ct;++o){n+="<tr>";n+='<td class="text-right">'+ ++ht+"<\/td>";var l=Math.floor(u.hp+u.hpr*o*24.999984401809389),a=Math.floor(u.str+u.strr*o),v=Math.floor(u.def+u.defr*o),y=Math.floor(u.ats+u.atsr*o),p=Math.floor(u.adf+u.adfr*o),nt=Math.floor(u.spd+u.spdr*o),wt=Math.floor(u.dex+u.dexr*o),bt=Math.floor(u.agl+u.aglr*o);1==d.clo&&g_cloth>0&&(l+=Math.ceil(l*.02*g_cloth),a+=Math.ceil(a*.02*g_cloth),v+=Math.ceil(v*.02*g_cloth),y+=Math.ceil(y*.02*g_cloth),p+=Math.ceil(p*.02*g_cloth));l+=it;a+=rt;v+=g;y+=ut;p+=ft;nt+=et;lt=Math.floor((l*4+a*10+y*10+v*5+p*5)*nt/200);n+='<td class="text-right">'+lt+"<\/td>";n+='<td class="text-right">'+l+"<\/td>";n+='<td class="text-right">'+a+"<\/td>";n+='<td class="text-right">'+v+"<\/td>";n+='<td class="text-right">'+y+"<\/td>";n+='<td class="text-right">'+p+"<\/td>";n+='<td class="text-right">'+nt+"<\/td>";n+='<td class="text-right">'+wt+"<\/td>";n+='<td class="text-right">'+bt+"<\/td>";n+="<\/tr>"}$(ot).html(n)}for(n="<br />",at=r.craft.length,f=0;f<at;++f){for(b=r.craft[f],n+='<div class="panel panel-default">',n+='<div class="panel-heading">'+b.lv[0].namej+"<\/div>",n+='<div class="panel-body">',n+='<table class="table table-sm"><thead><tr>',n+='<td class="table-head text-center">LV<\/td>',n+='<td class="table-head text-center">CP<\/td>',n+='<td class="table-head text-center">'+g_power+"<\/td>",n+='<td class="table-head text-center">'+g_delay+"<\/td>",n+='<td class="table-head">'+g_craft+"<\/td>",n+="<\/tr><\/thead><tbody>",w=0;w<b.lv.length;++w){for(s=b.lv[w],n+="<tr>",n+='<td class="text-center">'+(w+1)+"<\/td>",n+='<td class="text-center">'+(s.cp>0?s.cp:"")+"<\/td>",n+='<td class="text-center">'+(s.pwr>0?s.pwr:"")+"<\/td>",n+='<td class="text-center">'+(s.dly>0?s.dly:"")+"<\/td>",n+="<td>"+s.namej,k=0;k<s.notej.length;++k)n+="<br />"+s.notej[k];n+="<\/td>";n+="<\/tr>"}n+="<\/tbody><\/table>";n+="<\/div>";n+="<\/div>"}$("#chcr").html(n);$("#dlgDetail").modal("show")}});$("body").on("click",".tr-custom",function(){var t=parseInt($(this).attr("data-value")),r=Math.floor(t/10),u=t%10,n,i;0==g_trcpick?(g_weapon=20,g_weaponc=t,n=$("#divWeaponC")):(g_armor=20,g_armorc=t,n=$("#divArmorC"));i=g_rome[r];u>0&&(i+="+"+u);n.text(i);n.removeClass("rank1");n.removeClass("rank2");n.removeClass("rank3");n.removeClass("rank4");n.removeClass("rank5");n.addClass("rank"+((r>>1)+1));UpdateEquipment();UpdateDisplay();$("#dlgPickEnh").modal("hide")});$(".chara-filter").click(function(){var t=$(this).attr("data-target"),n=$(this).attr("data-value"),i;"type"==t?g_type=parseInt(n):"genre"==t?g_genre=parseInt(n):"at"==t?g_at=parseInt(n):"gender"==t?g_gender=parseInt(n):"weapon"==t?(i=parseInt(n),i<20?(g_weapon=i,UpdateEquipment()):(g_trcpick=0,$("#dlgPickEnh").modal("show"))):"armor"==t?(i=parseInt(n),i<20?(g_armor=parseInt(n),UpdateEquipment()):(g_trcpick=1,$("#dlgPickEnh").modal("show"))):"cloth"==t&&(g_cloth=parseInt(n),UpdateEquipment());UpdateDisplay()});$(".chara-filter-image").click(function(){var n=$(this).find("span");n&&1==n.length&&(n=n[0],$(n).hasClass("glyphicon-ok")?($(n).removeClass("glyphicon-ok"),g_bigimg=0):($(n).addClass("glyphicon-ok"),g_bigimg=1),UpdateDisplay())});$(document).ready(function(){for(var r,t,n,i="",u=0;u<10;++u){for(r=0;r<10;++r)i+='<div class="btn btn-default btn-xs tr-custom rank'+((u>>1)+1)+'" data-value="'+(u*10+r)+'">',i+=g_rome[u],r>0&&(i+="+"+r),i+="<\/div>";i+="<br />"}for($("#divPickEnh").html(i),t=0;t<g_ch.length;++t)n=g_chad[t].lv[10],g_curch.push({oi:t,ch:g_ch[t],chn:g_chn[t],mlv:{hp:Math.floor(n.hp+n.hpr*24.999984401809389*2),str:Math.floor(n.str+n.strr*2),def:Math.floor(n.def+n.defr*2),ats:Math.floor(n.ats+n.atsr*2),adf:Math.floor(n.adf+n.adfr*2),spd:Math.floor(n.spd+n.spdr*2),dex:Math.floor(n.dex+n.dexr*2),agl:Math.floor(n.agl+n.aglr*2)},chf:{pow:0,hp:0,str:0,def:0,ats:0,adf:0,spd:0,cri:0,dex:0,agl:0,hpd:0,strd:0,defd:0,atsd:0,adfd:0,spdd:0},sc:t});UpdateEquipment();SortChara();UpdateDisplay()});